<!DOCTYPE html>
<html>
  <head>
    <title>99Fridays - Conquered by Clippy</title>
    <meta charset="UTF-8" />

    <link rel="stylesheet" href="https://unpkg.com/xp.css" />

    <style>
        body {
            width: 100%;
            background-image: url('bg.jpg');
            background-size: cover;
        }
    </style>

  </head>

  <body>
    <div class="window" style="position: absolute; top: 100px; right: 100px; width: 500px; z-index:100001;">
        <div class="title-bar">
          <div class="title-bar-text">
            Document1 - Microsoft Word
          </div>
  
          <div class="title-bar-controls">
            <button aria-label="Minimize"></button>
            <button aria-label="Maximize"></button>
            <button aria-label="Close"></button>
          </div>
        </div>
        <div class="window-body">
          <p>99Fridays Presents</p>
          <p>Conquered by Clippy (WORD ART HERE)</p>
          <p>Tales of a Degenerative AI</p>
        </div>
      </div>

    <div id="source" class="window" style="position: absolute; top: 500px; left: 500px; z-index:10000; width: 300px">
      <div class="title-bar">
        <div class="title-bar-text">
          
        </div>

        <div class="title-bar-controls">
          <button aria-label="Minimize"></button>
          <button aria-label="Maximize"></button>
          <button aria-label="Close"></button>
        </div>
      </div>
      <div class="window-body">
        <p>Do you want to escape?</p>
        <section class="field-row" style="justify-content: flex-end">
          <button>OK</button>
          <button>Cancel</button>
        </section>
      </div>
    </div>
  </body>

  <script>
    var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
    var height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;

    
    let window_x = (width - 300) / 2;
    let window_y = height / 2;

    console.log(window_x, window_y);

    document.addEventListener("DOMContentLoaded", function(event) { 
        let s = document.getElementById("source");

        s.style.left = window_x + "px";
        s.style.top = window_y + "px";
    });

    function getRandomInt(max) {
        return Math.floor(Math.random() * max);
    }

    
    var z = 9999;
    setInterval(function() {
        let s = document.getElementById("source");
        let s_copy = s.cloneNode(true);

        window_x -= 10;
        window_y -= 10;

        if (window_x < 0 || window_y < 0) {
            if (Math.random() > 0.5) {
                window_x = getRandomInt(width - 300);
                window_y = height - 100;
            } else {
                window_x = width - 300;
                window_y = getRandomInt(height - 100);
            }
        }

        s_copy.style.left = window_x + "px";
        s_copy.style.top = window_y + "px";
        s_copy.style.zIndex = z;

        document.body.appendChild(s_copy);

        z -= 1;
    }, 70);
</script>
</html>